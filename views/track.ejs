<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <title><%= title %> - <%= artist %></title>
</head>
<body>
    <%- include("partials/nav") %>
   
<div class="container mt-4">
    <h1 class="mb-4"><%= title %> - <%= artist %></h1>
    <!-- iTunes data -->
        <% if (track) { %>
            
            <div class = "border rounded p-3 mb-3 bg-light">
                 <div class="row">
                <div class="col-md-4 text-center">
                    <% if(track.artworkUrl100) { %>
                    <% let bigArt = track.artworkUrl100.replace('100x100bb', '600x600bb'); %>
                        <img src="<%= bigArt %>" alt="Album Art" class="img-thumbnail mb-3"
                        style="width:180px; height:180px;"/>
                <% } %>

                </div>

                <div class="col-md-8">
                <h3>iTunes Info</h3>
                <p><strong>Track:</strong> <%= track.trackName %></p>
                <p><strong>Artist:</strong> <%= track.artistName %></p>

                <% if (track.collectionName) { %>
                    <p><strong>Album:</strong> <%= track.collectionName %></p>
                <% } %>

                <% if (track.previewUrl) { %>
                    <div class="mt-3">
                        <audio controls>
                            <source src="<%= track.previewUrl %>" type="audio/mpeg">
                        </audio>
                    </div>
                <% } %>

                <% if (track.trackViewUrl) { %>
                    <p class="mt-3">
                        <a href="<%= track.trackViewUrl %>" target="_blank" class="btn btn-primary">
                            View on iTunes</a>
                    </p>
                <% } %>
            </div>

          </div>
          </div>
       
        <% } %>





    <!-- Last.fm data -->
        <% if (lastfm) { %>
       <div class="border rounded p-3 mb-4">
           <h3>Last.fm Info</h3>


           <% if (lastfm.wiki && lastfm.wiki.summary) { %>
               <h5>Summary</h5>
               <p><%- lastfm.wiki.summary %></p>
           <% } %>


           <% if (lastfm.duration) { %>
               <p><strong>Duration:</strong> <%= (lastfm.duration / 1000).toFixed(0) %> seconds</p>
           <% } %>


           <% if (lastfm.toptags && lastfm.toptags.tag && lastfm.toptags.tag.length > 0) { %>
               <h5>Tags</h5>
               <ul class="list-inline">
                   <% lastfm.toptags.tag.forEach(t => { %>
                       <li class="list-inline-item badge bg-secondary mb-1"><%= t.name %></li>
                   <% }); %>
               </ul>
           <% } %>
       </div>
   <% } %>


   <% if (!track && !lastfm && !error) { %>
       <p>No data found for this song.</p>
   <% } %>

   <% if (error) { %>
       <div class="alert alert-danger"><%= error %></div>
    <% } %>
</div>

   <%- include('partials/footer') %>

    
</body>
</html>  

