<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="/css/style.css" />
  <title>Search Results</title>
</head>
<body>

    <%- include('partials/nav') %>

    <main class="container my-4">
        <h1 class="mb-4">Search Results</h1>

        <form method="get" action="/searching" class="row g-3 mb-4">
            <div class="col-md-8">
                <input name="q" class="form-control" placeholder="Search iTunes" value="<%=term%>">
            </div>

            <div class="col-md-4">
                <button class="btn btn-primary w-100">Search</button>
            </div>
        </form>

        <% if (error){%>
            <div class="alert alert-danger"><%= error %></div>
        <% } %>

        <% if(results && results.length){%>
            <div class="row g-3">
                <% results.forEach(function(track){%>
                    <div class="col-12 col-md-6">
                        <div class="border rounded p-3 h-100 d-flex">
                            <%if (track.artworkUrl100){%>
                                <img
                                src="<%=track.artworkUrl100%>"
                                alt="Album art"
                                class="me-3 rounded"
                                width="100" height="100">
                            <%}%>
                            <div>
                                <h5 class="mb-1"><%=track.trackName%></h5>
                                <p class="mb-1 text-muted">
                                    <%=track.artistName%>
                                    <% if (track.collectionName){%>
                                      â€¢ <%= track.collectionName%>   
                                  <% }%>
                                </p>
                                <% if (track.previewUrl){ %>
                                    <audio controls style="width:100;">
                                        <source src="<%= track.previewUrl%>" type="audio/mpeg">
                                    </audio>
                                <%}%>
                                <% if(track.ViewUrl){%>
                                    <div class="mt-2">
                                        <a href="<%= track.trackViewUrl %>" target="_blank">
                                            View on iTunes
                                        </a>
                                    </div>
                                <%}%>
                            </div>
                        </div>
                    </div>

                <%});%>
            </div>
        <%}%>

    </main>

    <%- include('partials/footer') %>
</body>
</html>